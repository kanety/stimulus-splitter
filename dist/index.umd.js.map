{"version":3,"file":"index.umd.js","sources":["../src/store.js","../src/index.js"],"sourcesContent":["export default class Store {\n  constructor(controller) {\n    this.controller = controller;\n  }\n\n  get key() {\n    return this.controller.storeKeyValue;\n  }\n\n  get splitters() {\n    return this.controller.splitters;\n  }\n\n  load() {\n    if (!this.key) return;\n\n    let data = this.constructor.load(this.key);\n    if (!data) return;\n\n    this.splitters.forEach(splitter => {\n      let size = data[this.controller.getID(splitter)];\n      let pane = splitter.previousElementSibling;\n      if (this.controller.isVertical(splitter)) {\n        pane.style.width = size[0] + 'px';\n      } else {\n        pane.style.height = size[1] + 'px';\n      }\n    });\n  }\n\n  save() {\n    if (!this.key) return;\n\n    let data = {};\n    this.splitters.forEach(splitter => {\n      let pane = splitter.previousElementSibling;\n      data[this.controller.getID(splitter)] = [pane.offsetWidth, pane.offsetHeight];\n    });\n    this.constructor.save(this.key, data);\n  }\n\n  static load(key) {\n    let json = sessionStorage.getItem(key);\n    try {\n      return JSON.parse(json)\n    } catch {\n      return null;\n    }\n  }\n\n  static save(key, value) {\n    sessionStorage.setItem(key, JSON.stringify(value));\n  }\n}\n","import { Controller } from '@hotwired/stimulus';\nimport '@kanety/stimulus-static-actions';\nimport Store from './store';\nimport './index.scss';\n\nexport default class extends Controller {\n  static targets = ['pane', 'splitter'];\n  static values = {\n    updateTarget: String,\n    storeKey: String\n  };\n  static actions = [\n    ['element', 'mousedown@document->start'],\n    ['element', 'touchstart@document->start']\n  ];\n  static dragActions = [\n    ['element', 'mousemove@document->move'],\n    ['element', 'touchmove@document->move'],\n    ['element', 'mouseup@document->end'],\n    ['element', 'touchend@document->end'],\n    ['element', 'selectstart@document->prevent']\n  ];\n\n  get splitters() {\n    return this.scope.findAllElements('[data-splitter-id]');\n  }\n\n  initialize() {\n    this.store = new Store(this);\n  }\n\n  connect() {\n    this.store.load();\n  }\n\n  start(e) {\n    this.splitter = this.splitters.find(splitter => splitter == e.target);\n    if (!this.splitter) return;\n\n    [this.startX, this.startY] = this.getXY(e);\n    let pane1 = this.splitter.previousElementSibling;\n    let pane2 = this.splitter.nextElementSibling;\n    this.startSize1 = { width: pane1.offsetWidth, height: pane1.offsetHeight };\n    this.startSize2 = { width: pane2.offsetWidth, height: pane2.offsetHeight };\n\n    this.toggleClass(this.splitter, true);\n    this.disableIframe(true);\n    this.context.actionSet.add(this.constructor.dragActions);\n  }\n\n  move(e) {\n    let [x, y] = this.getXY(e);\n    let pane1 = this.splitter.previousElementSibling;\n    let pane2 = this.splitter.nextElementSibling;\n\n    if (this.isVertical(this.splitter)) {\n      let width1 = this.startSize1.width + (x - this.startX);\n      let width2 = this.startSize2.width - (x - this.startX);\n      if (this.updateTargetValue == 'both' || this.updateTargetValue == 'width:both') {\n        if (width1 > 0 && width2 > 0) {\n          pane1.style.width = width1 + 'px';\n          pane2.style.width = width2 + 'px';\n        }\n      } else {\n        if (width1 > 0) {\n          pane1.style.width = width1 + 'px';\n        }\n      }\n    } else {\n      let height1 = this.startSize1.height + (y - this.startY);\n      let height2 = this.startSize2.height - (y - this.startY);\n      if (this.updateTargetValue == 'both' || this.updateTargetValue == 'height:both') {\n        if (height1 > 0 && height2 > 0) {\n          pane1.style.height = height1 + 'px';\n          pane2.style.height = height2 + 'px';\n        }\n      } else {\n        if (height1 > 0) {\n          pane1.style.height = height1 + 'px';\n        }\n      }\n    }\n  }\n\n  end(e) {\n    this.toggleClass(this.splitter, false);\n    this.disableIframe(false);\n    this.context.actionSet.remove(this.constructor.dragActions);\n\n    this.dispatch('resized', { detail: { splitter: this.splitter }});\n    this.splitter = null;\n    this.store.save();\n  }\n\n  prevent(e) {\n    e.preventDefault();\n  }\n\n  getXY(e) {\n    return [\n      e.changedTouches ? e.changedTouches[0].pageX : e.pageX,\n      e.changedTouches ? e.changedTouches[0].pageY : e.pageY\n    ];\n  }\n\n  toggleClass(splitter, dragging) {\n    if (dragging) {\n      splitter.classList.add('st-splitter--dragging');\n    } else {\n      splitter.classList.remove('st-splitter--dragging');\n    }\n  }\n\n  getID(splitter) {\n    return splitter.getAttribute('data-splitter-id');\n  }\n\n  isVertical(splitter) {\n    return splitter.parentNode.classList.contains('st-splitter-vertical');\n  }\n\n  disableIframe(disabled) {\n    document.querySelectorAll('iframe').forEach(iframe => {\n      iframe.style.pointerEvents = disabled ? 'none' : '';\n    })\n  }\n}\n"],"names":["Store","constructor","controller","this","key","storeKeyValue","splitters","load","data","forEach","splitter","size","getID","pane","previousElementSibling","isVertical","style","width","height","save","offsetWidth","offsetHeight","static","json","sessionStorage","getItem","JSON","parse","value","setItem","stringify","Controller","scope","findAllElements","initialize","store","connect","start","e","find","target","startX","startY","getXY","pane1","pane2","nextElementSibling","startSize1","startSize2","toggleClass","disableIframe","context","actionSet","add","dragActions","move","x","y","width1","width2","updateTargetValue","height1","height2","end","remove","dispatch","detail","prevent","preventDefault","changedTouches","pageX","pageY","dragging","classList","getAttribute","parentNode","contains","disabled","document","querySelectorAll","iframe","pointerEvents","targets","values","updateTarget","String","storeKey","actions"],"mappings":"qXAAqBA,EACnBC,YAAYC,GACVC,KAAKD,WAAaA,EAGhBE,UACF,YAAYF,WAAWG,cAGrBC,gBACF,YAAYJ,WAAWI,UAGzBC,OACE,GAAKJ,KAAKC,IAAV,CAEA,IAAII,EAAOL,KAAKF,YAAYM,KAAKJ,KAAKC,KACjCI,GAELL,KAAKG,UAAUG,QAAQC,IACrB,IAAIC,EAAOH,EAAKL,KAAKD,WAAWU,MAAMF,IAClCG,EAAOH,EAASI,uBAChBX,KAAKD,WAAWa,WAAWL,GAC7BG,EAAKG,MAAMC,MAAQN,EAAK,GAAK,KAE7BE,EAAKG,MAAME,OAASP,EAAK,GAAK,QAKpCQ,OACE,GAAKhB,KAAKC,IAAV,CAEA,IAAII,EAAO,GACXL,KAAKG,UAAUG,QAAQC,IACrB,IAAIG,EAAOH,EAASI,uBACpBN,EAAKL,KAAKD,WAAWU,MAAMF,IAAa,CAACG,EAAKO,YAAaP,EAAKQ,gBAElElB,KAAKF,YAAYkB,KAAKhB,KAAKC,IAAKI,IAGvBc,YAAClB,GACV,IAAImB,EAAOC,eAAeC,QAAQrB,GAClC,IACE,OAAOsB,KAAKC,MAAMJ,GAClB,SACA,aAIOD,YAAClB,EAAKwB,GACfJ,eAAeK,QAAQzB,EAAKsB,KAAKI,UAAUF,qBC9ClBG,aAkBvBzB,gBACF,YAAY0B,MAAMC,gBAAgB,sBAGpCC,aACE/B,KAAKgC,MAAQ,IAAInC,EAAMG,MAGzBiC,UACEjC,KAAKgC,MAAM5B,OAGb8B,MAAMC,GAEJ,GADAnC,KAAKO,SAAWP,KAAKG,UAAUiC,KAAK7B,GAAYA,GAAY4B,EAAEE,QACzDrC,KAAKO,SAAV,EAECP,KAAKsC,OAAQtC,KAAKuC,QAAUvC,KAAKwC,MAAML,GACxC,IAAIM,EAAQzC,KAAKO,SAASI,uBACtB+B,EAAQ1C,KAAKO,SAASoC,mBAC1B3C,KAAK4C,WAAa,CAAE9B,MAAO2B,EAAMxB,YAAaF,OAAQ0B,EAAMvB,cAC5DlB,KAAK6C,WAAa,CAAE/B,MAAO4B,EAAMzB,YAAaF,OAAQ2B,EAAMxB,cAE5DlB,KAAK8C,YAAY9C,KAAKO,UAAU,GAChCP,KAAK+C,eAAc,GACnB/C,KAAKgD,QAAQC,UAAUC,IAAIlD,KAAKF,YAAYqD,cAG9CC,KAAKjB,GACH,IAAKkB,EAAGC,GAAKtD,KAAKwC,MAAML,GACpBM,EAAQzC,KAAKO,SAASI,uBACtB+B,EAAQ1C,KAAKO,SAASoC,mBAE1B,GAAI3C,KAAKY,WAAWZ,KAAKO,UAAW,CAClC,IAAIgD,EAASvD,KAAK4C,WAAW9B,OAASuC,EAAIrD,KAAKsC,QAC3CkB,EAASxD,KAAK6C,WAAW/B,OAASuC,EAAIrD,KAAKsC,QACjB,QAA1BtC,KAAKyD,mBAAyD,cAA1BzD,KAAKyD,kBACvCF,EAAS,GAAKC,EAAS,IACzBf,EAAM5B,MAAMC,MAAQyC,EAAS,KAC7Bb,EAAM7B,MAAMC,MAAQ0C,EAAS,MAG3BD,EAAS,IACXd,EAAM5B,MAAMC,MAAQyC,EAAS,UAG5B,CACL,IAAIG,EAAU1D,KAAK4C,WAAW7B,QAAUuC,EAAItD,KAAKuC,QAC7CoB,EAAU3D,KAAK6C,WAAW9B,QAAUuC,EAAItD,KAAKuC,QACnB,QAA1BvC,KAAKyD,mBAAyD,eAA1BzD,KAAKyD,kBACvCC,EAAU,GAAKC,EAAU,IAC3BlB,EAAM5B,MAAME,OAAS2C,EAAU,KAC/BhB,EAAM7B,MAAME,OAAS4C,EAAU,MAG7BD,EAAU,IACZjB,EAAM5B,MAAME,OAAS2C,EAAU,OAMvCE,IAAIzB,GACFnC,KAAK8C,YAAY9C,KAAKO,UAAU,GAChCP,KAAK+C,eAAc,GACnB/C,KAAKgD,QAAQC,UAAUY,OAAO7D,KAAKF,YAAYqD,aAE/CnD,KAAK8D,SAAS,UAAW,CAAEC,OAAQ,CAAExD,SAAUP,KAAKO,YACpDP,KAAKO,SAAW,KAChBP,KAAKgC,MAAMhB,OAGbgD,QAAQ7B,GACNA,EAAE8B,iBAGJzB,MAAML,GACJ,MAAO,CACLA,EAAE+B,eAAiB/B,EAAE+B,eAAe,GAAGC,MAAQhC,EAAEgC,MACjDhC,EAAE+B,eAAiB/B,EAAE+B,eAAe,GAAGE,MAAQjC,EAAEiC,OAIrDtB,YAAYvC,EAAU8D,GAChBA,EACF9D,EAAS+D,UAAUpB,IAAI,yBAEvB3C,EAAS+D,UAAUT,OAAO,yBAI9BpD,MAAMF,GACJ,OAAOA,EAASgE,aAAa,oBAG/B3D,WAAWL,GACT,OAAOA,EAASiE,WAAWF,UAAUG,SAAS,wBAGhD1B,cAAc2B,GACZC,SAASC,iBAAiB,UAAUtE,QAAQuE,IAC1CA,EAAOhE,MAAMiE,cAAgBJ,EAAW,OAAS,eArH9CK,QAAU,CAAC,OAAQ,cACnBC,OAAS,CACdC,aAAcC,OACdC,SAAUD,UAELE,QAAU,CACf,CAAC,UAAW,6BACZ,CAAC,UAAW,iCAEPjC,YAAc,CACnB,CAAC,UAAW,4BACZ,CAAC,UAAW,4BACZ,CAAC,UAAW,yBACZ,CAAC,UAAW,0BACZ,CAAC,UAAW"}